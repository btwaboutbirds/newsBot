# –°–∫—Ä–∏–ø—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è PowerShell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: .\activate.ps1
# 
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ö–æ–¥–∏—Ç –ø—Ä–æ–±–ª–µ–º—É —Å Execution Policy

Write-Host "üîß –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è NewsBot..." -ForegroundColor Cyan

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if (-Not (Test-Path ".\venv\Scripts\Activate.ps1")) {
    Write-Host "‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!" -ForegroundColor Red
    Write-Host "–°–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π: python -m venv venv" -ForegroundColor Yellow
    exit 1
}

# –ü–æ–ø—ã—Ç–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å –æ–±—Ö–æ–¥–æ–º Execution Policy
try {
    # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é
    & ".\venv\Scripts\Activate.ps1" -ErrorAction Stop
} catch {
    # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –∏–∑-–∑–∞ Execution Policy, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å
    Write-Host "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å Execution Policy, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å..." -ForegroundColor Yellow
    $env:VIRTUAL_ENV = (Resolve-Path ".\venv").Path
    $env:PATH = "$env:VIRTUAL_ENV\Scripts;$env:PATH"
    
    # –£–¥–∞–ª—è–µ–º PYTHONHOME, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    if ($env:PYTHONHOME) {
        Remove-Item Env:PYTHONHOME
    }
    
    Write-Host "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ (–æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å)!" -ForegroundColor Green
    $LASTEXITCODE = 0
}

if ($LASTEXITCODE -eq 0) {
    Write-Host "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!" -ForegroundColor Green
    Write-Host ""
    Write-Host "üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:" -ForegroundColor Cyan
    Write-Host "  python main.py                    - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞" -ForegroundColor White
    Write-Host "  python parse_and_save_news.py     - –ü–∞—Ä—Å–∏–Ω–≥ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π" -ForegroundColor White
    Write-Host "  python test_parser.py             - –¢–µ—Å—Ç HTML –ø–∞—Ä—Å–µ—Ä–∞" -ForegroundColor White
    Write-Host "  deactivate                        - –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ" -ForegroundColor White
    Write-Host ""
} else {
    Write-Host "‚ùå –û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è!" -ForegroundColor Red
    exit 1
}

